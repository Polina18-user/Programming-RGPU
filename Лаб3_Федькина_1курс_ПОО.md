# Лабораторная работа №3
## Тема лабортатоной работы: Объединения и перечисления
##  Задача 1- указатель на объединение
### Постановка задачи
Напишите программу, которая использует указатель на некоторое объединение (union). Создайте и проинициализи
руйте переменные в объединении через указатель, затем выведите их значения на экран.
### Математическая модель 
Отсутствует
### Список идентификаторов
| Имя |Тип|Смысл|
|-----|---|-----|
|user1|union User|Экземпляр объединения User|
### Код программы
```c
#include <stdio.h>
int birth(int x)
{
    return 2025-x;
}

union User
{
    char name[20];
    char surname[20];
    int (*year)(int);//указатель на функцию
};

int main(void)
{
    
    union User user1;
    // Инициализируем поле name
    snprintf(user1.name,sizeof(user1.name),"Ольга");
    printf("Имя: %s\n",user1.name);

    snprintf(user1.surname,sizeof(user1.surname),"Петрова");
    printf("Фамилия: %s \n",user1.surname);

    user1.year=birth;

    int age=1956;
    int res=user1.year(age);//Вызов функции через указатель
    printf("Возраст:%d\n",res);

    return 0;
}
```
### Результаты
<img width="307" height="153" alt="1" src="https://github.com/user-attachments/assets/92c1de39-8ad4-4ed7-a000-428c414a05f1" />

##  Задача 2- побайтовая распечатка числа
### Постановка задачи
 Напишите программу,которая использует объединение(union)для побайтовой распечатки значения переменной типа
 unsigned long. Каждый байт должен быть выведен отдельно через указатель на char.
### Математическая модель
Отсутствует
### Список идентификаторов
| Имя |Тип|Смысл|
|-----|---|-----|
|data|union BytePr|Экземпляр объединения BytePr|
|*str|unsigned char|Строка -указатель, хранящая ссылку на значение тип строка|
### Код программы
```c
#include <stdio.h>
union BytePr
{
    unsigned long  val;
    unsigned char bytes[sizeof(unsigned long)];
};

int main (void)
{
    union BytePr data;
    data.val =0x123456;//Пример значения

    unsigned char *str=(unsigned char *)&data.val;//строка-указатель, хранящая ссылку на значение типа строка

    printf("Побайтовое представление unsigned long (size = %zu байт): \n",sizeof(unsigned long));
    for (size_t i=0; i<sizeof(unsigned long); i++)
    {
        printf("Byte %zu: 0x%02X\n",i,*(str+i));
    }
    return 0;
}
```
### Результаты
<img width="515" height="142" alt="2" src="https://github.com/user-attachments/assets/8f61166d-faf8-4260-872d-99c1b5483951" />

## Задача 3- перечисление дней недели
### Постановка задачи:
 Создайте перечислимый тип данных (enum) для семи дней недели. Реализуйте программу, которая выводит на экран
 значения каждого дня недели как целое число.
### Математическая модель 
 Отсутствует
### Список идентификаторов
Отсутствует
### Код программы
```c
#include <stdio.h>
enum DayOfWeek
{
    Monday=1,
    Tuesday,
    Wednesday,
    Thursday,
    Friday,
    Saturday,
    Sunday
};

int main(void)
{
    printf("Monday: %d \n", Monday);
    printf("Tuesday: %d \n", Tuesday);
    printf("Wednesday: %d \n", Wednesday);
    printf("Thursday: %d \n", Thursday);
    printf("Friday: %d \n", Friday);
    printf("Saturday: %d \n", Saturday);
    printf("Sunday: %d \n", Sunday);

    return 0;
}
```
### Результаты
<img width="310" height="217" alt="3" src="https://github.com/user-attachments/assets/3da00d49-dd59-4480-ba67-6aa37499a87e" />

## Задача 4- размеченное объединение
### Постановка задачи:
 Создайте размеченное объединение (union), которое заключено в структуру. Структура должна также содержать пе
речисление (enum), служащее индикатором того, какой тип данных хранится в объединении на текущий момент. Со
здайте динамический массив таких структур и реализуйте функцию для распечатки их содержимого на экран.
### Математическая модель
Отсутствует
### Список идентификаторов
| Имя |Тип|Смысл|
|-----|---|-----|
|array|struct TaggedUnion|Экземпляр структуры TaggedUnion|
|size|size_t|Количество элементов массива|

### Код программы
```c
#include <stdio.h>
#include <stdlib.h>
// Перечисление для индикации типа данных в объединении
typedef enum
{
    TYPE_INT,
    TYPE_FLOAT,
    TYPE_CHAR
} DataType;

// Объединение с разными типами данных
typedef union 
{
    int i;
    float f;
    char c;
} DataUnion;

// Структура, содержащая объединение и индикатор типа
typedef struct
{
    DataType type;
    DataUnion data;
}TaggedUnion;

// Функция для печати содержимого массива структур
void printTaggedUnionArray(TaggedUnion* arr,size_t size)
{
    for (size_t i=0;i<size;i++)
    {
        printf("Элемент %zu: ",i);
        switch (arr[i].type)
        {
            case TYPE_INT:
                printf("int=%d\n", arr[i].data.i);
                break;
            case TYPE_FLOAT:
                printf("float=%f\n",arr[i].data.f);
                break;
            case TYPE_CHAR:
                printf("char=%c\n",arr[i].data.c);
                break;
            default:
                printf("неизвестный тип\n");
        
        }
    }
}

int main(void)
{
    size_t size=5;

    //Динамическое выделение массива
    TaggedUnion* array=malloc(size*sizeof(TaggedUnion));
    if (!array) {
        perror("malloc failed");
        return 1;
    }

    // Инициализация элементов массива
    array[0].type=TYPE_INT; array[0].data.i=42;
    array[1].type=TYPE_FLOAT; array[1].data.f=3.14f;
    array[2].type=TYPE_CHAR; array[2].data.c='z';
    array[3].type = TYPE_INT;   array[3].data.i = -7;
    array[4].type = TYPE_CHAR;  array[4].data.c = 'z';

    // Печать содержимого
    printTaggedUnionArray(array,size);

    // Освобождение памяти
    free(array);
    return 0;
}
```
### Результаты
<img width="327" height="181" alt="4" src="https://github.com/user-attachments/assets/13227b86-e008-439e-ba3c-dd945a94654e" />

## Задача 5- ввод и хранение данных о студентах
### Постановка задача:
 Создайте структуру, в которой используется объединение для хранения различных типов данных: например, структу
ра с отдельным полем для имени студента и отдельное поле– целое число для его возраста либо строка его возраста
 словами. Реализуйте программу для динамического ввода данных о студентах и вывода их на экран
 ### Математическая модель
 Отсутствует
 ### Список идентификаторов
| Имя |Тип|Смысл|
|-----|---|-----|
|n|int|Количество элементов массива|
|students|struct Student|Экземпляр структура Student|
 ### Код программы
 ```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define NAME_LEN 50
#define AGE_TEXT_LEN 30

typedef enum{
    AGE_INT,
    AGE_TEXT
}AgeType;

typedef union
{
    int ageNumber;
    char ageText[AGE_TEXT_LEN];
}AgeUnion;

typedef struct 
{
    char name[NAME_LEN];
    AgeType ageType;
    AgeUnion age;
}Student;

// Чтение студента с динамическим вводом возраста
void inputStudent(Student* student)
{
    printf("Введите имя студента: ");
    fgets(student->name, NAME_LEN,stdin);
    student->name[strcspn(student->name, "/n")]=0;
// Убираем символ новой строки
    printf("Введите тип возраста: (0 - число, 1 - словами): ");
    int type;
    scanf("%d",&type);
    while (getchar()!='\n');//Очистка
    if (type==0)
    {
        student->ageType=AGE_INT;
        printf("Введите возраст (числом): ");
        scanf("%d",&student->age.ageNumber);
        while (getchar()!='\n');
    }
    else
    {
        student->ageType=AGE_TEXT;
        printf("Введите возраст (словами): ");
        fgets(student->age.ageText,AGE_TEXT_LEN,stdin);
        student->age.ageText[strcspn(student->age.ageText,"\n")]=0;
    }
}
void printStudent(const Student* student)
{
    printf("Имя: %s, Возраст: ",student->name);
    if (student->ageType==AGE_INT)
    {
        printf("%d\n",student->age.ageNumber);
    }
    else
    {
        printf("%s\n",student->age.ageText);
    }
}
int main(void)
{
    int n;
    printf("Сколько студентов хотите ввести? ");
    scanf("%d", &n);
    while (getchar()!='\n');

    Student* students=malloc(n*sizeof(Student));
    if (!students)
    {
        perror("Ошибка выделения памяти");
        return 1;
    }

    for (int i=0;i<n;i++)
    {
        printf("\nСтудент %d: \n",i+1);
        inputStudent(&students[i]);
    }

    printf("\nВведенные данные: \n");
    for (int i=0; i<n;i++)
    {
        printStudent(&students[i]);
    }

    free(students);
    return 0;

}

```
 ### Результат
 <img width="492" height="442" alt="5" src="https://github.com/user-attachments/assets/cbed0f73-6359-477f-a8be-e54f728911f2" />

## Задача 6- управление состояниями системы через enum
### Постановка задача:
 Используйте перечисление (enum) для управления состояниями некоторой условной системы, например, старт, стоп,
 пауза. Напишите программу, которая изменяет состояние системы и выводит текущее состояние на экран.
 ### Математическая модель
 Отсутствует
 ### Список идентификаторов
| Имя |Тип|Смысл|
|-----|---|-----|
|currentState|enum State|Экземпляр перечисления State|
 ### Код программы
 ```c
#include <stdio.h>

// Объявление перечисления для состояний системы
typedef enum
{
    START,
    STOP,
    PAUSE
} State;

// Функция для вывода текстового описания состояния
void printState(State state)
{
    switch(state)
    {
        case START:
            printf("Состояние: START (старт)\n");
            break;
        case STOP:
            printf("Состояние: STOP (стоп)\n");
            break;
        case PAUSE:
            printf("Состояние: PAUSE (пауза)\n");
            break;
        default:
        printf("Неизвестное состояние\n");
    }
}
int main(void)
{
    State currentState=STOP;// начальное состояние

    printState (currentState);

    // Изменяем состояние на старт
    currentState=START;
    printState(currentState);

    // Изменяем состояние на паузу
    currentState = PAUSE;
    printState(currentState);

    // Изменяем состояние на стоп
    currentState = STOP;
    printState(currentState);

    return 0;
}

```
 ### Результат
 <img width="301" height="170" alt="6" src="https://github.com/user-attachments/assets/24012cdd-a003-4814-aefb-0e638c455bf7" />

##  Задача 7- оптимизация памяти для хранения данных о температуре и влажности
### Постановка задачи:
Создайте структуру с битовыми полями для хранения показаний температуры (в градусах Цельсия) и влажности (в
 процентах). Реализуйте ввод данных с клавиатуры и их корректное хранение в структуре с минимальным потребле
нием памяти.
 • Температура может быть от-50 до +50 градусов Цельсия (нужно выделить минимальное количество бит).
 • Влажность может быть от 0 до 100%
 ### Математическая модель
 Отсутсвует
 ## Список идентификаторов
| Имя |Тип|Смысл|
|-----|---|-----|
|data1|struct Data|Экземпляр структуры Data|
 ### Код программы
 ```c
#include <stdio.h>

struct Data
{    
    signed int temp: 7;//-50-50-1=101 2^7=128
    unsigned int vlag: 7;
};

int main(void)
{
    struct Data data1;
    int temp_input,vlag_input;

    printf("Введите температуру (-50..50): ");
    scanf("%d",&temp_input);
    if (temp_input< -50 || temp_input>50)
    {
        printf("Ошибка: температура вне диапазона!\n");
        return 1;
    }
    printf("Введите влажность (0..100): ");
    scanf("%d",&vlag_input);
    if (vlag_input< 0 || vlag_input>100)
    {
        printf("Ошибка: влажность вне диапазона!\n");
        return 1;
    }
    //Сохраняем с учетом смещения температуры
   // Используется смещение для температуры: температура + 50,
   // чтобы значение было неотрицательное (0..100).
   data1.temp=temp_input+50;
   data1.vlag=vlag_input;

   //Вывод для проверки
   printf("Температура: %d градусов Цельсия\n",data1.temp-50);
   printf("Влажность: %d %%\n",data1.vlag);
   return 0;

}
```
### Результаты
<img width="337" height="147" alt="7" src="https://github.com/user-attachments/assets/05b6f6a5-b5b5-44cd-91ed-71e3512b190f" />

##  Задача 8- ввод и вывод через enum и union
### Постановка задачи
Создайте программу,котораяпозволяетпользователювводитьивыводитьинформациюсразличнымитипамиданных
через перечисления и объединения. Например, пользователь может выбрать ввод данных как числа или строки, и
программа корректно сохранит и отобразит эти данные.
### Математическая модель
Отсутствует
### Список идентификаторов
| Имя |Тип|Смысл|
|-----|---|-----|
|choice|enum DataType|Экземляр перечисления DataType|
|data|union Value|Экземпляр объединения Value|
### Код программы
```c
#include <stdio.h>
#include <string.h>

// Перечисление для выбора типа данных
typedef enum
{
    TYPE_INT,
    TYPE_CHAR
}DataType;

// Объединение для хранения разных типов данных
typedef union
{
    int int_t;
    char str_t[100];
} Value;

int main(void)
{
    DataType choice;
    Value data;

    printf("Введите тип данных для ввода: \n");
    printf("0 - Число\n");
    printf("1 - Строка\n");
    printf("Введите выбор: \n");
    if (scanf("%d",(int*)&choice)!=1 || (choice!=TYPE_INT && choice!=TYPE_CHAR))
    {
        printf("Неверный выбор!\n");
        return 1;
    }

    //Очистка входного буфера после scanf
    while (getchar()!='\n');

    if (choice==TYPE_INT)
    {
        printf("Введите число: ");
        if (scanf("%d",&data.int_t)!=1)
        {
            printf("Ошибка ввода числа\n");
            return 1;
        }
    }
    else
    {
        printf("Введите строку: ");
        if (fgets(data.str_t, sizeof(data.str_t),stdin)==NULL)
        {
            printf("Ошибка ввода строки\n");
            return 1;
        }
        // Удаляем символ новой строки из строки, если он есть
        data.str_t[strcspn(data.str_t,"\n")]='\0';
    }
    //Вывод результата
    printf("\nВведенные данные: ");
    if (choice==TYPE_INT)
    {
        printf("Число - %d\n",data.int_t);
    }
    else
    {
        printf("Строка -\" %s\"\n",data.str_t);
    }
    return 0;
}

```
### Результаты
<img width="320" height="176" alt="8" src="https://github.com/user-attachments/assets/33b016b6-5833-49d5-aa23-35ddd9f69a96" />

### Информация о студенте
Федькина Полина Дмитриевна ПОО 1 курс.
